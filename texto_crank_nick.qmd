---
title: Método de Crank Nickolson
lang: es
execute: 
  freeze: auto
---
::: {style="text-align: justify"}
Existen métodos implícitos de diferencias finitas para resolver ecuaciones diferenciales parciales parabólicas [ec @eq-heat]. Estos métodos requieren la resolución de un sistema de ecuaciones para determinar los valores aproximados de $u$ en la línea de tiempo $(j + 1)$. Sin embargo, los métodos implícitos no presentan problemas de inestabilidad [@zill2008].

El algoritmo introducido por **J. Crank** y **P. Nicholson** en 1947 se utiliza principalmente para resolver la ecuación del calor. El algoritmo consiste en sustituir la segunda derivada parcial en $c\frac{\partial^2 u}{\partial x^2} = \frac{\partial u}{\partial t}$ por el promedio de dos cocientes de diferencias centrales, uno evaluado en $t$ y el otro en $t+k$:
$$
\begin{split}
\dfrac{c}{2}& \left[\dfrac{u(x+h,t)-2u(x,t)+u(x-h,t)}{h^2}\right] + \\
    + &\dfrac{c}{2} \left[\dfrac{u(x+h,t+k)-2u(x,t+k)+u(x-h,t+k)}{h^2} \right] \\
            &= \dfrac{1}{k}[u(x,t+k)-u(x,t)]
\end{split}
$$ {#eq-cn-completa}

si se define $\lambda = \frac{ck}{h^2}$ y
$$
\begin{split}
u(x+h,t) &=u_{i+1,j}, \quad u(x,t)=u_{ij}, \quad u(x-h,t)=u_{i-1,j}, \\
u(x+h,t+k) &=u_{i+1,j+1}, \quad u(x,t+k)=u_{i.j+1}, \quad u(x-h,t+k)=u_{i-1,j+1},
\end{split}
$$

es posible reescribir a la [ec @eq-cn-completa] como:
$$
-u_{i-1,j+1} + \alpha u_{i,j+1} - u_{i+1,j+1} = u_{i+1,j} - \beta u_{ij} + u_{i-1,j},
$$ {#eq-cn-reducida}

donde $\alpha=2(1+\frac{1}{\lambda})$, $\beta=2(1-\frac{1}{\lambda})$, $j=0,1,\dots m-1 \ \ \ \text{e} \ \ \ i=0,1,\dots n-1$.

Para cada elección de $j$ la ecuación diferencial [ec @eq-cn-reducida] para $i=0,1,\dots n-1$ da $n-1$ ecuaciones en $n-1$ incógnitas $u_{i,j+1}$. Debido a las condiciones de contorno preestablecidas, los valores de $u_{i, j+1}$ se conocen para $i=0$ y para $i=n$. Por ejemplo, en el caso $n=4$, el sistema de ecuaciones para determinar los valores aproximados de $u$ en la línea de tiempo $(j+1)$ es:

$$
\begin{split}
-u_{0,j+1} + \alpha u_{1,j+1} - u_{2,j+1} =& u_{2,j} - \beta u_{1,j} + u_{0,j} \\
-u_{1,j+1} + \alpha u_{2,j+1} - u_{3,j+1} =& u_{3,j} - \beta u_{2,j} + u_{1,j} \\
-u_{2,j+1} + \alpha u_{3,j+1} - u_{4,j+1} =& u_{4,j} - \beta u_{3,j} + u_{2,j}
\end{split}
$$

reordenando se llega a
$$
\begin{matrix}
\alpha u_{1,j+1} &-& u_{2,j+1}&& &= b_1 \\
-u_{1,j+1} &+& \alpha u_{2,j+1} &-& u_{3,j+1} &= b_2 \\
&-&u_{2,j+1} &+& \alpha u_{3,j+1} &= b_3
\end{matrix}
$$ {#eq-cn-matrix}

donde
\begin{align*}
b_1 &= u_{2,j} - \beta u_{1,j} + u_{0,j} + u_{0,j+1}, \\
b_2 &= u_{3,j} - \beta u_{2,j} + u_{1,j}, \\
b_3 &= u_{4,j} - \beta u_{3,j} + u_{2,j} + u_{4,j+1}.
\end{align*}

En general, si utilizamos la ecuación diferencial [ec @eq-cn-reducida]  para determinar valores de $u$ en la línea de tiempo $(j -1)$, es necesario resolver un sistema lineal $\mathbf{AX=B}$, donde la matriz de coeficientes $\mathbf{A}$ es una **matriz tridiagonal**,
$$
A = 
\begin{pmatrix}
\alpha & -1    & 0      & 0      & 0      & \cdots & 0 & 0      \\
-1     & \alpha & -1     & 0      & 0      & \cdots & 0 & 0      \\
0      & -1     & \alpha & -1     & 0      & \cdots & 0 & 0      \\
0      & 0      & -1     & \alpha & -1     & \cdots & 0 & 0      \\
\vdots & \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0      & 0      & 0      & 0      & 0      & \cdots & \alpha & -1 \\
0      & 0      & 0      & 0      & 0      & \cdots & -1     & \alpha
\end{pmatrix},
$$

y las componentes de la matriz columna $\mathbf{B}$ son

\begin{align*}
b_1 &= u_{2,j} - \beta u_{1,j} + u_{0,j} + u_{0,j+1}, \\
b_2 &= u_{3,j} - \beta u_{2,j} + u_{1,j}, \\
b_3 &= u_{4,j} - \beta u_{3,j} + u_{2,j}, \\
    &\vdots \\
b_{n-1} &= u_{n,j} - \beta u_{n-1,j} + u_{n-2,j} + u_{n,j+1}.
\end{align*}
:::